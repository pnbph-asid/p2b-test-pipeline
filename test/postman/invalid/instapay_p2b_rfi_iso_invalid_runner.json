{
	"info": {
		"_postman_id": "30b831ec-8e19-4762-bbdd-faf330f4c3ea",
		"name": "ISO20022 Automated Test -  Invalid",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "200 - Auth",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Authentication Successful Status Code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							" var jsonData = pm.response.json();",
							"",
							"pm.collectionVariables.set(\"bearerToken\", jsonData.token);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"username\": \"e2e-client-sit\",\n\t\"password\": \"P@ssw0rd\"\n}",
					"options": {
						"raw": {
							"headerFamily": "json",
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/api/auth",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"auth"
					]
				}
			},
			"response": []
		},
		{
			"name": "400 - Invalid SN - Validation Request",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var requestBody = JSON.parse(pm.request.body);",
							"",
							"var jsonData = pm.response.json();",
							"",
							"",
							"pm.test(\" Invalid Subscriber Number Status Code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\" Invalid Subscriber Number Status is REJECTED\", function () {",
							"    pm.expect(jsonData.txnStatus).to.have.eql(\"REJECTED\");});",
							"",
							"",
							"pm.test(\" Invalid Subscriber Number Status is BE15\", function () {",
							"    pm.expect(jsonData.reason).to.have.eql(\"BE15\");});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"const currentDate = new Date();\r",
							"\r",
							"const month = String(currentDate.getMonth() + 1).padStart(2, '0'); \r",
							"const day = String(currentDate.getDate()).padStart(2, '0');\r",
							"\r",
							"const year = String(currentDate.getFullYear()).slice(-2);\r",
							"\r",
							"const txnDate = `${month}${day}`;\r",
							"\r",
							"const hours = String(currentDate.getHours()).padStart(2, '0');\r",
							"const minutes = String(currentDate.getMinutes()).padStart(2, '0');\r",
							"const seconds = String(currentDate.getSeconds()).padStart(2, '0');\r",
							"\r",
							"const txnTime = `${hours}${minutes}${seconds}`;\r",
							"\r",
							"pm.environment.set('txnDate', txnDate);\r",
							"pm.environment.set('txnTime', txnTime);\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{bearerToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "API-Version",
						"value": "2.0.0",
						"description": "Version of the API Endpoint"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"instructionId\": \"2025{{txnDate}}BNNNPH22XXXB0000{{$timestamp}}\",\n\t\"ofiBic\": \"BNNNPH22XXX\",\n\t\"payerAccountName\": \"{{payerAccountName}}\",\n\t\"payerAccountNo\": \"11000179512199001\",\n\t\"rfiBic\": \"PNBMPHMMTOD\",\n\t\"billerId\": \"{{billerId}}\",\n\t\"txnAmount\": \"{{txnAmount}}\",\n\t\"txnDateTime\": \"2024-01-01T00:00:00\",\n\t\"txnStatus\": \"\",\n\t\"subscriberNo\": \"{{subscriberNo}}\",\n\t\"additionalSubscriberNo\": \"{{additionalSubscriberNo}}\",\n\t\"purpose\": \"{{testCase}}\"\n}",
					"options": {
						"raw": {
							"headerFamily": "json",
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/api/billspayment/validate",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"billspayment",
						"validate"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "bearerToken",
			"value": ""
		},
		{
			"key": "baseIdGenerated",
			"value": "false",
			"type": "string"
		},
		{
			"key": "validateIdGenerated",
			"value": "false",
			"type": "string",
			"disabled": true
		},
		{
			"key": "creditIdGenerated",
			"value": "false",
			"type": "string",
			"disabled": true
		},
		{
			"key": "payerAccountName",
			"value": "",
			"type": "default"
		}
	]
}